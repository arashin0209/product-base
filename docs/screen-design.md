# Product Base - 画面設計書

## 1. 設計方針

### 1.1 デザインシステム
- **UIライブラリ**: shadcn/ui
- **CSS フレームワーク**: Tailwind CSS
- **テーマ**: Light/Dark モード対応
- **レスポンシブ**: モバイル・タブレット・デスクトップ対応

### 1.2 共通レイアウト原則
- モダンでクリーンなデザイン
- 直感的なナビゲーション
- 一貫したスタイリング
- アクセシビリティ準拠

## 2. 認証関連画面

### 2.0 共通ヘッダー仕様

#### 2.0.1 認証画面でのヘッダー
- **ログイン前**: シンプルなロゴのみ表示
- **ログイン後**: フルヘッダー（ハンバーガーメニュー + プラン選択 + 設定メニュー）

### 2.1 ログイン画面 (`/login`)

#### 2.1.1 レイアウト構成
```
┌─────────────────────────────────┐
│     Product-base ロゴ           │
├─────────────────────────────────┤
│                                 │
│     ┌─────────────────────┐     │
│     │   ログイン画面      │     │
│     │                     │     │
│     │  メールアドレス     │     │
│     │  ┌───────────────┐   │     │
│     │  │               │   │     │
│     │  └───────────────┘   │     │
│     │                     │     │
│     │  パスワード         │     │
│     │  ┌───────────────┐   │     │
│     │  │               │   │     │
│     │  └───────────────┘   │     │
│     │                     │     │
│     │  ┌─── ログイン ───┐   │     │
│     │  └─────────────────┘   │     │
│     │                     │     │
│     │      または          │     │
│     │                     │     │
│     │  ┌── Googleログイン ──┐  │     │
│     │  └─────────────────┘   │     │
│     │                     │     │
│     │  新規登録はこちら    │     │
│     └─────────────────────┘     │
│                                 │
└─────────────────────────────────┘
```

#### 2.1.2 コンポーネント仕様
- **Container**: `max-w-md` 中央配置
- **Card**: shadcn/ui Card コンポーネント
- **Input**: メール・パスワード入力フィールド
- **Button**: プライマリボタン（ログイン）、アウトラインボタン（Google）
- **Link**: テキストリンク（新規登録）

#### 2.1.3 状態管理
- **ローディング状態**: ボタン内スピナー表示
- **エラー状態**: toast通知でエラーメッセージ表示
- **バリデーション**: リアルタイム入力検証

### 2.2 新規登録画面 (`/signup`)

#### 2.2.1 追加要素
- **名前入力フィールド**: ユーザー名
- **パスワード確認フィールド**: 確認用パスワード入力
- **利用規約同意**: チェックボックス + リンク
- **登録完了**: 確認メッセージ表示

#### 2.2.2 バリデーション
- パスワード: 8文字以上、英数字2種類以上混在
- パスワード確認: 一致チェック
- 利用規約: 同意必須

## 3. メイン画面

### 3.1 ダッシュボード (`/dashboard`)

#### 3.1.1 レイアウト構成
```
┌─────────────────────────────────────────────────┐
│ [☰ Menu] [Product Base ▼]                      │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌─────────────────┐                           │
│  │   プラン情報    │                           │
│  │                 │                           │
│  │  現在: Gold     │                           │
│  │  ステータス:    │                           │
│  │  次回更新日:    │                           │
│  │  2024/12/01     │                           │
│  └─────────────────┘                           │
│                                                 │
│  ┌─────────────────────────────────────────┐    │
│  │            AI チャット               │    │
│  │                                         │    │
│  │  ┌─ ユーザー ─────────────────────────┐  │    │
│  │  │ こんにちは！                     │  │    │
│  │  └─────────────────────────────────┘  │    │
│  │                                         │    │
│  │  ┌─ AI ───────────────────────────────┐  │    │
│  │  │ こんにちは！何かお手伝いできる   │  │    │
│  │  │ ことはありますか？               │  │    │
│  │  └─────────────────────────────────┘  │    │
│  │                                         │    │
│  │  ┌─────────────────────────────────┐   │    │
│  │  │ [    メッセージ入力エリア    ] [送信] │   │    │
│  │  └─────────────────────────────────┘   │    │
│  └─────────────────────────────────────────┘    │
│                                                 │
└─────────────────────────────────────────────────┘
```

#### 3.1.2 ヘッダー仕様

##### 3.1.2.1 レイアウト構成
```
┌─────────────────────────────────────────────────┐
│ [☰ Menu] [Product Base ▼]                      │
└─────────────────────────────────────────────────┘
```

##### 3.1.2.2 ヘッダー要素詳細
- **左側**: ハンバーガーメニュー（☰）+ プラン選択ドロップダウン
  - **ハンバーガーメニュー**:
    - トリガー: 左スライド式グローバルメニュー
    - アイコン: 3本線のハンバーガーアイコン
    - 位置: ヘッダー左端
  
  - **プラン選択ドロップダウン**:
    - 表示形式: `[Product Base ▼]` または `[Gold ▼]`
    - 位置: ハンバーガーメニューの右隣
    - ドロップダウン内容:
      ```
      ┌─────────────────────────┐
      │ 🆓 Free                 │
      │   基本的な機能          │
      │                         │
      │ ⭐ Gold                 │
      │   月1000回のAI機能      │
      │   [現在のプラン] ✓      │
      │                         │
      │ 💎 Platinum             │
      │   無制限のAI機能        │
      │   [アップグレード]      │
      └─────────────────────────┘
      ```
    - 現在のプラン表示: チェックマーク（✓）で表示
    - アップグレード案内: 非アクティブプランに「アップグレード」ボタン

##### 3.1.2.3 インタラクション仕様
- **プラン選択ドロップダウン**:
  - クリックでドロップダウン表示
  - 現在のプランをハイライト表示
  - プラン変更時は即座に反映
  - 外部クリックでドロップダウン閉じる

#### 3.1.3 機能要素
- **ヘッダーナビゲーション**: ハンバーガーメニュー、プラン選択ドロップダウン
- **プラン情報カード**: 現在のプラン、ステータス表示（詳細は機能要件書3.4.4参照）
  - アクティブ継続予定: "次回更新日: 2024/12/01"
  - キャンセル予定: "2024/12/01にキャンセル予定"  
  - トライアル中: "トライアル期間: 2024/11/15まで"
  - 支払い失敗: "支払い方法の更新が必要です"
  - 支払い確認中: "支払い確認中です"
- **AIチャット機能**: メイン機能としてページ中央に配置
  - チャット履歴表示エリア（直近5件まで表示）
  - テキスト入力エリア（リサイズ可能）
  - 送信ボタン
  - ローディング表示
  - 使用回数表示（Goldプラン: 残り800/1000回）
- **プラン制限表示**: 無料プランユーザー向けアップグレード案内

### 3.2 ハンバーガーメニュー

#### 3.2.1 サイドドロワー内容
```
┌──────────────────┐
│      メニュー     │
├──────────────────┤
│ ユーザー名       │
│ user@example.com │
│ プラン: Gold     │
├──────────────────┤
│ 🏠 ホーム        │
│   + 新しいチャット│
│   + チャットを検索│
│ 💳 プラン設定    │
│ 👤 プロフィール  │
│ 🚪 ログアウト     │
└──────────────────┘
```

#### 3.2.2 機能仕様
- **表示方式**: 左スライド式ドロワー（Sheet コンポーネント）
- **トリガー**: ヘッダー左上のハンバーガーアイコン
- **表示デバイス**: PC・タブレット・スマホ全対応
- **ユーザー情報表示**: 名前、メール、現在プラン
- **メニュー項目**:
  - **ホーム**（メイン画面へ遷移）
    - **新しいチャット**: チャット履歴をクリアして新しいチャットを開始
    - **チャットを検索**: 過去のチャット履歴を検索（将来実装予定）
  - **プラン設定**（プラン選択画面へ遷移）
  - **プロフィール**（プロフィール設定画面へ遷移）
  - **ログアウト**（確認なし、即座にログアウト実行）

#### 3.2.3 チャット管理機能
- **新しいチャット**:
  - 現在のチャット履歴をクリア
  - ページをリロードして新しいチャットセッションを開始
  - メニューを自動的に閉じる

- **チャットを検索**:
  - 過去のチャット履歴を検索する機能（将来実装予定）
  - 現在はコンソールログ出力のみ
  - メニューを自動的に閉じる

## 4. プラン・決済関連画面

### 4.1 プラン選択画面 (`/pricing`)

#### 4.1.1 レイアウト構成
```
┌───────────────────────────────────────────────────────┐
│                プラン選択                             │
├───────────────────────────────────────────────────────┤
│                                                       │
│ ┌─── FREE ────┐ ┌─── GOLD ────┐ ┌── PLATINUM ──┐    │
│ │             │ │             │ │              │    │
│ │    ¥0       │ │   ¥980      │ │    ¥2,980    │    │
│ │   /月       │ │   /月       │ │     /月      │    │
│ │             │ │             │ │              │    │
│ │ ✗ AI機能    │ │ ✓ OpenAI    │ │ ✓ OpenAI     │    │
│ │             │ │   月1000回  │ │   無制限     │    │
│ │             │ │ ✓ 1週間無料  │ │ ✓ 優先サポート │    │
│ │             │ │   トライアル │ │ ✓ 高性能モデル │    │
│ │             │ │             │ │              │    │
│ │             │ │             │ │              │    │
│ │ [現在のプラン] │ │[アップグレード]│ │[アップグレード]│  │
│ └─────────────┘ └─────────────┘ └──────────────┘    │
│                                                       │
└───────────────────────────────────────────────────────┘
```

#### 4.1.2 機能仕様
- **プランカード**: 価格、機能一覧、CTA ボタン
- **比較表**: 機能比較を分かりやすく表示
- **トライアル表示**: 無料期間の明確な表示
- **現在プラン表示**: ユーザーの現在プランをハイライト

### 4.2 Stripe Checkout

#### 4.2.1 遷移フロー
1. プラン選択 → Stripe Checkout画面
2. 決済情報入力（Stripe提供画面）
3. 決済完了 → ダッシュボードにリダイレクト
4. Webhook → プラン情報更新

### 4.3 Billing Portal

#### 4.3.1 管理機能
- 請求履歴確認
- 支払い方法変更
- プランキャンセル
- 請求書ダウンロード

## 5. 設定・管理画面

### 5.1 プロフィール設定 (`/profile`)

#### 5.1.1 設定項目
```
┌─────────────────────────────────┐
│        プロフィール設定          │
├─────────────────────────────────┤
│                                 │
│ 基本情報                        │
│ ┌─────────────────────────────┐ │
│ │ 名前    [            ]      │ │
│ │ メール  [            ]      │ │
│ │         (変更不可)           │ │
│ └─────────────────────────────┘ │
│                                 │
│ アカウント管理                   │
│ ┌─────────────────────────────┐ │
│ │ [パスワード変更]             │ │
│ │ [アカウント削除]             │ │
│ └─────────────────────────────┘ │
│                                 │
│                                 │
│              [保存]             │
└─────────────────────────────────┘
```

## 6. エラー・特殊画面

### 6.1 エラー画面

#### 6.1.1 404 Not Found
```
┌─────────────────────────────────┐
│            404              │
│      ページが見つかりません      │
│                                 │
│     ┌─── ホームに戻る ───┐      │
│     └─────────────────────┘      │
└─────────────────────────────────┘
```

#### 6.1.2 500 Server Error
```
┌─────────────────────────────────┐
│            500              │
│       サーバーエラー            │
│   しばらく待ってから再度お試し    │
│       ください                  │
│                                 │
│     ┌──── 再試行 ────┐          │
│     └─────────────────┘          │
└─────────────────────────────────┘
```

### 6.2 認証エラー画面 (`/auth/error`)
```
┌─────────────────────────────────┐
│          認証エラー             │
│                                 │
│   ログインに失敗しました         │
│                                 │
│     ┌── 再ログイン ──┐          │
│     └─────────────────┘          │
└─────────────────────────────────┘
```

### 6.3 ローディング画面

#### 6.3.1 初期ローディング
- スケルトンUI表示
- プログレスバー
- ロゴアニメーション

## 7. レスポンシブ対応

### 7.1 ブレイクポイント
- **Mobile**: `< 640px`
- **Tablet**: `640px - 1024px`
- **Desktop**: `> 1024px`

### 7.2 モバイル対応
- ハンバーガーメニュー（左スライド式）
- タッチフレンドリーなボタンサイズ
- スワイプジェスチャー対応

### 7.3 タブレット対応
- ハンバーガーメニュー（左スライド式）
- グリッドレイアウト最適化
- 横画面対応

### 7.4 デスクトップ対応
- ハンバーガーメニュー（左スライド式）
- プラン選択ドロップダウン（左側、ハンバーガーメニューの隣）
- マウスホバー効果
- キーボードショートカット対応
- ドロップダウンメニューの適切な配置

## 8. アクセシビリティ

### 8.1 キーボード操作
- Tab キーナビゲーション
- Enter/Space キーでの操作
- Escape キーでのモーダルクローズ

### 8.2 スクリーンリーダー対応
- 適切な見出しレベル
- ALT テキスト設定
- ARIA ラベル付与

### 8.3 カラーコントラスト
- WCAG 2.1 AA 準拠
- カラーブラインド対応
- ダークモード配色

## 9. パフォーマンス最適化

### 9.1 画像最適化
- Next.js Image コンポーネント使用
- WebP 形式対応
- 遅延ローディング

### 9.2 コード分割
- 動的インポート
- ルートベースコード分割
- コンポーネント遅延読み込み

### 9.3 キャッシュ戦略
- 静的アセットキャッシュ
- API レスポンスキャッシュ
- ブラウザキャッシュ活用